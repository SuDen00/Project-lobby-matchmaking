# Overview

## 1. Назначение системы
Информационная система лобби и матчмейкинга предназначена для организации предварительного этапа сетевой игры в Steam.  
Система обеспечивает:
- создание комнаты с заданными параметрами;
- формирование и отображение списка доступных лобби;
- присоединение пользователя к выбранной комнате по списку или по коду.
Система рассматривается как отдельный компонент, который может быть интегрирован с игровым клиентом (например, в виде меню лобби в Unity).


## 2. Акторы системы
- **Пользователь**  
  - создаёт новую комнату (если выступает как создатель лобби);  
  - просматривает список доступных лобби;  
  - присоединяется к выбранному лобби по списку или по коду;  
  - при ошибках получает сообщения (нет такой комнаты, комната заполнена и т.п.).
- **Система лобби**  
  - принимает запросы пользователя;  
  - создаёт записи о лобби и участниках;  
  - формирует список доступных комнат с учётом состояния (открыта/закрыта);  
  - проверяет ограничения (лимит мест, тип доступа);  
  - возвращает результаты операций и сообщения об ошибках.
Создатель комнаты рассматривается как частный случай пользователя.


## 3. Основные сценарии работы
### 3.1. Создание комнаты
1. Пользователь открывает экран создания комнаты.  
2. Вводит название лобби и максимальное число игроков.  
3. Выбирает тип доступа (публичная / приватная по коду).  
4. Отправляет запрос на создание.  
5. Система создаёт запись о лобби, генерирует код (для приватной комнаты) и помечает лобби как доступное для присоединения.  
6. Пользователь видит созданную комнату и, при необходимости, код для приглашения.

### 3.2. Просмотр списка комнат
1. Пользователь открывает экран списка лобби.  
2. Система считывает из базы данных актуальный набор открытых лобби.  
3. Система отображает список с основными параметрами (название, тип, занято/максимум мест, признак приватности).  
4. Пользователь может обновить список.

### 3.3. Присоединение к комнате
Вариант А - по списку:
1. Пользователь выбирает комнату в списке.  
2. Система проверяет, что лобби существует, не закрыто и в нём есть свободные места.  
3. При успешной проверке система добавляет пользователя в состав участников лобби.  
4. Пользователь попадает в интерфейс комнаты.
Вариант Б - по коду приглашения:
5. Пользователь вводит код лобби.  
6. Система находит соответствующую комнату.  
7. Далее выполняются шаги 2–4, как в варианте А.  
8. При ошибке (неверный код, комната заполнена) система возвращает сообщение об ошибке.


## 4. Ограничения и допущения
- Рассматривается только пре-матч этап: создание лобби, список лобби, присоединение.  
- В проект не входят:  
  - распределение ролей и статусов готовности;  
  - запуск и проведение игрового матча;  
  - чат, друзья, рейтинги и системы подбора по уровню.  
- Предполагается использование Steam в качестве платформы авторизации и транспортного уровня, но детали реализации сетевого протокола находятся вне рамок документа.


## 5. Требования к системе
### 5.1. Функциональные требования
F1. Система должна предоставлять интерфейс создания комнаты с указанием названия, типа доступа и максимального числа игроков.  
F2. Система должна формировать и отображать список доступных лобби с основными параметрами.  
F3. Система должна обеспечивать присоединение пользователя к лобби по выбору из списка.  
F4. Система должна обеспечивать присоединение пользователя к лобби по коду приглашения.  
F5. При невозможности присоединения (комната не найдена, закрыта, заполнена) система должна возвращать понятное сообщение об ошибке.

### 5.2. Нефункциональные требования
NF1. Обновление списка лобби и проверка возможности присоединения должны выполняться за время не более 1 секунды при типовой нагрузке.  
NF2. Система должна обеспечивать целостность данных: пользователь не может быть добавлен в лобби сверх максимального количества участников.  
NF3. Все операции создания и присоединения должны протоколироваться (лог событий) для отладки и анализа.  
NF4. Интерфейс должен поддерживать русскую локализацию.


## 6. Данные и интеграция с БД
Основные сущности данных:
- **Lobby** (id, name, type, join_code, max_players, current_players, status, created_at);  
- **Player** (id, display_name, platform_id);  
- **Member** (lobby_id, player_id, joined_at).
Хранение реализуется в базе данных PostgreSQL.  
Схема таблиц и SQL-скрипты приведены в каталоге `db/` (файлы `schema.sql`, `seed.sql`).
